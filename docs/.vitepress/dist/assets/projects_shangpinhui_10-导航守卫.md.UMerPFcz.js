import{_ as a,c as e,o as t,a4 as r,ds as i,dt as o,du as l,dv as s,dw as n}from"./chunks/framework.C8gDNRqg.js";const k=JSON.parse('{"title":"导航守卫","description":"","frontmatter":{},"headers":[],"relativePath":"projects/shangpinhui/10-导航守卫.md","filePath":"projects/shangpinhui/10-导航守卫.md"}'),_={name:"projects/shangpinhui/10-导航守卫.md"},p=r('<h1 id="导航守卫" tabindex="-1">导航守卫 <a class="header-anchor" href="#导航守卫" aria-label="Permalink to &quot;导航守卫&quot;">​</a></h1><blockquote><p>导航表示路由正在发生变化，要进行路由跳转；守卫会对跳转进行限制，符合条件才放行。守卫分三种：全局（前置和后置）、路由独享守卫、组件内守卫。这些导航守卫要定义在 src/router/index.js 里的路由实例 router 下面。在<a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html" target="_blank" rel="noreferrer"> 这里 </a>可以查看 vue2 详细的官方文档。</p></blockquote><h2 id="_1-全局前置守卫" tabindex="-1">1. <strong>全局前置守卫</strong> <a class="header-anchor" href="#_1-全局前置守卫" aria-label="Permalink to &quot;1. **全局前置守卫**&quot;">​</a></h2><ul><li>例 1：当用户未登录，全局前置守卫负责将其带到登录页面。</li></ul><p><img src="'+i+'" alt="image.png"></p><ul><li><p>例 2（重点）：访问任何页面时，token 校验机制全过程</p><p><img src="'+o+'" alt="image.png"></p><ul><li>存在问题 1：根据这样的代码可以成功拦截用户的非法访问行为，但存在一个问题，游客在访问交易类型页面时，会自动跳转至登录页，按照需求来说，登录成功后应该重定向到用户的目标地址，但由于我们在写登录页的代码时，登陆成功后是毫无疑问跳转到 Home 主页的，这就产生了分歧。所以我们要更改 Login 模块无条件跳转 Home 主页的代码，应该先判断$route.query 中是否有 redirect 参数，有则重定向，否则才跳转至 Home。</li></ul><p><img src="'+l+'" alt="image.png"></p><p>这张截图是“立即登录”按钮的点击事件，灰框内容是原来写的，红框是改善后的。</p><ul><li>存在问题 2：交易成功的页面是不能直接访问的，只能由用户在支付页面支付成功后跳转。这个问题需要用“路由独享守卫”来解决。</li></ul></li></ul><h2 id="_2-路由独享守卫" tabindex="-1">2. 路由独享守卫 <a class="header-anchor" href="#_2-路由独享守卫" aria-label="Permalink to &quot;2. 路由独享守卫&quot;">​</a></h2><ul><li>思路：见上述存在问题 2</li><li>代码：在路由 index.js 中进行以下改善。</li></ul><p><img src="'+s+'" alt="image.png"></p><p>同理，进入提交订单页面（Trade）只能从购物车页面跳转，进入加购成功（addCartSuccess）只能从商品详情页面跳转。</p><h2 id="_3-组件内守卫-使用较少" tabindex="-1">3. 组件内守卫（使用较少） <a class="header-anchor" href="#_3-组件内守卫-使用较少" aria-label="Permalink to &quot;3. 组件内守卫（使用较少）&quot;">​</a></h2><ul><li>用途：也能解决存在问题 2。</li><li>代码</li></ul><p><img src="'+n+'" alt="image.png"></p>',13),c=[p];function u(d,h,m,g,f,b){return t(),e("div",null,c)}const x=a(_,[["render",u]]);export{k as __pageData,x as default};
